<div class="text-red">
  <%if flash[:message].present?%>
      <%=flash[:message]%>
  <%end%>
</div>

<div>
  <p>  Event Name <%=@event.name%> </p><br>
  <p>Event Category: <%=@event.category%></p> <br>
  <p>Event Description: <%=@event.comment%></p><br>
  <p>Event Address: <%=@event.full_address%></p><br>
</div>
<br>
<%if @event.average_rating.present?%>
  <p> Average rating: <%= @event.average_rating%>
<%end%>
<br>
<br>

<%=@event.feedbacks.count%> Comments:
  <% @event.feedbacks.each do |feedback| %>
  <ul>
    <li><%= link_to feedback.user.name, user_path(feedback.user) %> said
    <%= feedback.content %>
    <%#if feedback.rating.any?%>
      <%=feedback.user.name%> rated <%=@event.name%> a <%=feedback.rating%> out of 10. </li>
    <%#end%>
    <%if feedback.user == current_user %>
      <%=link_to "edit this comment", edit_event_feedback_path(@event, feedback)%>
      <%=form_tag event_feedback_path(@event, feedback), method: "delete" do%>
        <%=submit_tag "delete your comment"%>
      <%end%>
      <%end%>
    <ul>
  <% end %>
<div>
<br>
<div class="">
  <%=link_to "Add A Comment and Rate this Event", new_event_feedback_path(@event)%>
</div>
<br>
  <%if @event.belongs_to_user(current_user)%>
    <div>
    <br>
      <%=link_to "Edit this Event", edit_event_path(@event) %>
    <br>
    </div>
    <div class="form">
      <%= form_tag event_path(@event.id), method: "delete" do %>
        <%= submit_tag "Delete #{@event.name}" %>
      <% end %>
    </div>
  <%end%>
</div>
<%# want this part shown only if event is not already in the user's events, and if user is not event.user (one who made it) %>
<%if !current_user.event_already_added?(@event) || @event.belongs_to_user(current_user)%>
  <div class="form">
    <%= form_tag user_event_path(@event.id), method: "post" do %>
    <br>
      <%label_tag "Comment" %>
      <%=text_field_tag "comment", :comment %>  <br>
      <%= submit_tag "Add #{@event.name} to your events" %>
    <% end %>
    <br>
  </div>
<%end%>

<div class="flex justify-center">
  <%= image_tag "http://maps.googleapis.com/maps/api/staticmap?center=#{@event.latitude},#{@event.longitude}&markers=#{@event.latitude},#{@event.longitude}&zoom=15&size=640x400&key=#{ENV['MY_KEY']}", #!!!!add key here
              class: 'img-fluid img-rounded', alt: "#{@event.name} on the map"%>
</div>
